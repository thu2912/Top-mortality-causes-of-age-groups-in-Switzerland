---
title: "Top Mortality causes in young adults and middle age adults in Switzerland"
subtitle: "Analyzing data from the WHO database"
author: 
  - Thu Dong
thanks: "Code and data are available at: https://github.com/thu2912/Top-mortality-causes-of-age-groups-in-Switzerland.git"
date: today
date-format: long
abstract: "This study employs Bayesian analysis to investigate mortality causes among young adults (aged 20 to below 40) and middle-aged adults (aged 40 to below 60) in Switzerland. Analyzing mortality data from national registries and healthcare databases, significant disparities in mortality causes between the two age groups are identified. The findings underscore the importance of targeted interventions and policy measures to address the distinct health needs of young and middle-aged adults. This research contributes to advancing understanding of mortality dynamics in Switzerland and informs evidence-based public health strategies."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(knitr)
library(modelsummary)
library(ggplot2)
library(dplyr)
library(rstanarm)
library(parameters)
library(broom)
library(broom.mixed)
```

```{r}
#| include: false
#| warning: false
#| message: false

clean_data_below40 <- read_csv( "~/Top-mortality-causes-of-age-groups-in-Switzerland/data/analysis_data/analysis_data_below40.csv")|>
  select(Year.x, Cause,Population,Deaths, Death_rate_per_100000, Age)

clean_data_above40 <- read_csv( "~/Top-mortality-causes-of-age-groups-in-Switzerland/data/analysis_data/analysis_data_above40.csv")|>
  select(Year.x, Cause,Population,Deaths, Death_rate_per_100000, Age)
```

# Introduction
In recent years, understanding the mortality causes among different age groups has become increasingly crucial for public health research and policy-making. Mortality patterns can vary significantly across age cohorts, reflecting not only the natural aging process but also the diverse lifestyle factors, socioeconomic conditions, and healthcare accessibility experienced by different demographic groups. In Switzerland, a country renowned for its high-quality healthcare system and favorable living standards, investigating mortality causes among young and middle-aged adults presents a compelling avenue for exploring the health dynamics within these cohorts.

This research aims to delve into the mortality causes prevalent among young adults (aged 20 to below 40) and middle-aged adults (aged 40 to below 60) in Switzerland, employing a Bayesian analytical approach. While numerous studies have investigated mortality trends in broader age categories or specific disease cohorts, there remains a paucity of research focusing explicitly on these two distinct age groups. By utilizing Bayesian methods, this study offers a novel perspective on mortality analysis, allowing for the incorporation of prior knowledge, uncertainty quantification, and robust inference in modeling mortality causes.

The findings of this research shed light on the stark differences in the top mortality causes between young and middle-aged adults in Switzerland. By examining comprehensive mortality data from national registries and healthcare databases, this study identifies and analyzes the leading causes of death within each age cohort, elucidating the underlying factors contributing to these disparities. Moreover, the Bayesian framework enables the exploration of uncertainty and variability in mortality patterns, providing valuable insights for policymakers, healthcare practitioners, and researchers in developing targeted interventions and preventive strategies tailored to the specific needs of each age group.

Through this research, we seek to contribute to the broader understanding of mortality dynamics in Switzerland and advance the discourse on public health initiatives aimed at reducing premature deaths and improving overall population health. By uncovering the distinct mortality landscapes among young and middle-aged adults, we aim to inform evidence-based policymaking and resource allocation strategies that address the unique health challenges faced by these demographic cohorts.

# Data {#sec-data}

## Raw Data 

## Clean Data


```{r}
#| label: tbl-data-below40
#| tbl-cap: Top 10 Mortality Causes in Switzerland for young adults in 2010 
#| echo: false
#| warning: false
#| message: false

#cleaned data
head(clean_data_below40, n=10)|>
  kable(
    col.names = c("Year", "Causes", "Population", "Deaths", "Death rate", "Age"), 
    align =  c("c","c","c","c","c","c")
  )
```

```{r}
#| label: tbl-data-above40
#| tbl-cap: Top 10 Mortality Causes in Switzerland for middle ages in 2010 
#| echo: false
#| warning: false
#| message: false

#cleaned data
head(clean_data_above40, n=10)|>
  kable(
    col.names = c("Year", "Causes", "Population", "Deaths", "Death rate", "Age"), 
    align =  c("c","c","c","c","c","c")
  )
```



```{r}
#| label: tbl-common_mortality_causes_below40
#| fig-cap: Common Mortality Causes for young adults in 2010,1015,and 2019
#| echo: false

top_10_2010_below40 <- clean_data_below40$Cause[clean_data_below40$Year.x == 2010]
top_10_2015_below40 <- clean_data_below40$Cause[clean_data_below40$Year.x == 2015]
top_10_2019_below40  <- clean_data_below40$Cause[clean_data_below40$Year.x == 2019]

common_causes_below40  <- intersect(intersect(top_10_2010_below40, top_10_2015_below40), top_10_2019_below40 )
# Calculate total deaths for each common cause of death
total_deaths_below40  <- aggregate(Deaths ~ Cause, subset(clean_data_below40, Cause %in% common_causes_below40), sum)

common_causes_below40_table <- total_deaths_below40  %>% 
  arrange(desc(Deaths))%>%
  head(5)

kable(common_causes_below40_table)
```
```{r}
#| label: tbl-common_mortality_causes_above40
#| fig-cap: Common Mortality Causes for middle age adults in 2010,1015,and 2019
#| echo: false

top_10_2010_above40 <- clean_data_above40$Cause[clean_data_above40$Year.x == 2010]
top_10_2015_above40 <- clean_data_above40$Cause[clean_data_above40$Year.x == 2015]
top_10_2019_above40  <- clean_data_above40$Cause[clean_data_above40$Year.x == 2019]

common_causes_above40  <- intersect(intersect(top_10_2010_above40, top_10_2015_above40), top_10_2019_above40 )
# Calculate total deaths for each common cause of death
total_deaths_above40  <- aggregate(Deaths ~ Cause, subset(clean_data_above40, Cause %in% common_causes_above40), sum)

common_causes_above40_table <- total_deaths_above40  %>% 
  arrange(desc(Deaths))%>%
  head(5)

kable(common_causes_above40_table)
```


```{r}
# #| label: fig-abc
# #| fig-cap: abc
#| echo: false
#| warning: false
#| message: false

datasummary(
  Deaths ~ Min + Mean + Max + SD + Var + N,
  fmt = 0,
  data = clean_data_below40
)

```

```{r}
# #| label: fig-abc
# #| fig-cap: abc
#| echo: false
#| warning: false
#| message: false

datasummary(
  Deaths ~ Min + Mean + Max + SD + Var + N,
  fmt = 0,
  data = clean_data_above40
)
```

```{r}
# #| label: fig-abc
# #| fig-cap: abc
#| echo: false
#| warning: false
#| message: false

clean_data_below40%>%
  filter(Cause %in% common_causes_below40_table$Cause) %>%
  ggplot(aes(x = Year.x, y = Deaths, color = Cause)) +
  geom_line() +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  labs(x = "Year", y = "Number of deaths")+
  scale_x_continuous(breaks = c(2010, 2015, 2019))+ 
  ylim(0,250)# Adjust the limits as needed
```

```{r}
# #| label: fig-abc
# #| fig-cap: abc
#| echo: false
#| warning: false
#| message: false

clean_data_above40%>%
  filter(Cause %in% common_causes_above40_table$Cause) %>%
  ggplot(aes(x = Year.x, y = Deaths, color = Cause)) +
  geom_line() +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  labs(x = "Year", y = "Number of deaths")+
  scale_x_continuous(breaks = c(2010, 2015, 2019))+ 
  ylim(100,650)# Adjust the limits as needed
```

# Model


## Model set-up



\begin{align} 
y_i|\mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \alpha + \beta_i + \gamma_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta &\sim \mbox{Normal}(0, 2.5) \\
\gamma &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1)
\end{align}



### Model justification



# Results

Our results are summarized in @tbl-modelresults.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

## Load models
cause_of_death_below40 <-
  readRDS(file ="~/Top-mortality-causes-of-age-groups-in-Switzerland/models/cause_of_death_below40.rds")
cause_of_death_above40 <-
  readRDS(file ="~/Top-mortality-causes-of-age-groups-in-Switzerland/models/cause_of_death_above40.rds")

```


```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
# #| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

modelsummary(
  list(
    " Below 40" = cause_of_death_below40
))
```
```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults1
# #| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

modelsummary(
  list(
    " Above 40" = cause_of_death_above40
))
```
```




# Discussion

## First discussion point {#sec-first-point}

```{r}

```


If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage


# References


